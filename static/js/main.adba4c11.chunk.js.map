{"version":3,"sources":["calculations/maps.ts","calculations/util.ts","ui/degrees-input.tsx","ui/number-input.tsx","PVArraysInfo/PVArrayInfo.tsx","PVArraysInfo/PVArraysInfo.tsx","util.ts","calculations/wh-factor.ts","display/energy-production.ts","display/AverageOutputPerDayByMonth.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["year","toRadians","Math","acos","tan","angle","PI","sin","currentYear","cos","asin","Date","getFullYear","daysInYear","maxDecRad","declinationsForYear","result","Array","i","orientationsToAzimuth","forEach","orientation","DegreesInput","props","num","_label","onChange","value","moreProps","className","htmlFor","name","String","charCodeAt","length","fromCharCode","aria-label","e","str","target","substr","Number","NumberInput","PVArrayInfo","remove","setVal","val","tilt","Object","keys","map","key","watts","onClick","PVArraysInfo","pvArrays","setPVArrays","pvArrayInit","removeArray","slice","pvArray","memoize","fn","cache","args","JSON","stringify","mTan","calculateWHFactorForYear","opts","dec","calculateWHFactorForDay","lat","intervalRad","F","n","a","b","Error","h","sum","simpson","x","hourAngle","percentage","instantIntensityPercentage","samplesPerDay","azimuth","sinLat","sinDec","cosHA","sinHA","cosLat","cosDec","altitude","cosAlt","tmp","getDaysInMonth","month","getDate","getAvgProdByMonth","pvArrayInfo","whFactorInfo","whFactorForYear","curDay","_","arr","monthFactors","reduce","acc","cur","whFactor","truncate","precision","factor","monthLabels","AverageOutputPerDayByMonth","getAvgProdsByMonth","useState","calculating","data","time","avgProdByMonth","setAvgProdByMonth","setTimeout","startTime","endTime","label","averageProduction","production","colSpan","style","border","lsPVArrays","window","localStorage","pvArraysInit","parse","latInit","samplesPerDayInit","App","setLat","setSamplesPerDay","latAdjusted","pvArraysCleaned","Boolean","location","hostname","match","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.adba4c11.chunk.js","sourcesContent":["import { toRadians } from \"./util\"\n\nconst {\n  sin,\n  cos,\n  asin,\n  acos,\n  PI\n} = Math\n\nconst currentYear = new Date().getFullYear()\nconst isLeapYear = year => year % 400 === 0 || (year % 100 !== 0 && year % 4 === 0)\nconst daysInYear = isLeapYear(currentYear) ? 366 : 365\nconst maxDecRad = toRadians(23.45)\nconst getDeclinationFromDayOfYear = dayOfYear => (\n  maxDecRad * sin(toRadians(360/365 * (dayOfYear - 81)))\n)\nexport const declinationsForYear = (() => {\n  const result = new Array(daysInYear)\n  for (let i = 0; i < daysInYear; i++) {\n    result[i] = getDeclinationFromDayOfYear(i)\n  }\n  return result\n})()\n\n\nexport const orientationsToAzimuth = (() => {\n  const orientations = [\n    'N',\n    'NNE',\n    'NE',\n    'ENE',\n    'E',\n    'ESE',\n    'SE',\n    'SSE',\n    'S',\n    'SSW',\n    'SW',\n    'WSW',\n    'W',\n    'WNW',\n    'NW',\n    'NNW',\n  ]\n  const result = {}\n  orientations\n    .forEach((orientation, i) => result[orientation]= i*22.5)\n  return result\n})()\n","const {\n  acos,\n  tan\n} = Math\nexport const toRadians = angle => angle * Math.PI / 180\nexport const toDegrees = angle => angle * 180 / Math.PI\n\nexport const simpson = (F, n, a, b) => {\n    if (n % 2 !== 0) {\n        throw new Error(\"n must be even\")\n    }\n    const h = (b - a) / n\n    let sum = F(a);\n\n    for (let i = 1; i < n; i++) {\n        sum += F(i*h + a) * (i % 2 == 0 ? 2 : 4)\n    }\n\n    sum += F(n*h)\n\n    return sum * h / 3\n}\n\n\n","import React from 'react'\nimport \"./degrees-input.css\"\n\n export const addDegree = num => {\n if (String(num).charCodeAt(num.length - 1) == 176) {\n    return num\n  }\n  return num + String.fromCharCode(176)\n}\nexport const removeDegree = str => {\n  if (str.charCodeAt(str.length - 1) == 176)\n    return str.substr(0, str.length - 1)\n  return Number(str)\n}\nexport const DegreesInput = props => {\n  const {_label, onChange, value, ...moreProps} = props\n  return <>\n    <label className=\"degrees-label\" htmlFor={_label}>{_label}</label>\n    <input\n      className=\"degrees-input\"\n      name={_label}\n      value={addDegree(value)}\n      aria-label={_label}\n      onChange={e => {\n        onChange(removeDegree(e.target.value))\n      }}\n      {...moreProps}\n\n    />\n  </>\n}","import React from 'react'\nimport \"./number-input.css\"\n\nexport const NumberInput = props => {\n  const {_label, ...moreProps} = props\n  return <>\n    <label className=\"number-label\" htmlFor={_label}>{_label}</label>\n    <input\n      className=\"number-input\"\n      name={_label}\n      aria-label={_label}\n      {...moreProps}\n    />\n  </>\n}","import React from 'react'\nimport { orientationsToAzimuth } from '../calculations/maps'\nimport { DegreesInput } from '../ui/degrees-input'\nimport \"./PVArrayInfo.css\"\nimport { NumberInput } from '../ui/number-input'\n\nexport const PVArrayInfo = ({remove, setVal, val}) => {\n  return <>\n    <div className=\"form-group\">\n      <DegreesInput\n        onChange={value => setVal(\"tilt\", value)}\n        _label=\"Tilt\"\n        value={val.tilt}\n      />\n    </div>\n    <div className=\"form-group\">\n      <label htmlFor=\"orientation\">Orientation</label>\n      <select\n        className=\"select-group\"\n        value={val.orientation}\n        onChange={e => setVal(\"orientation\", e.target.value)}\n      >\n        {\n          Object.keys(orientationsToAzimuth)\n            .map(orientation => (\n              <option\n              key={orientation}\n              value={orientation}\n              >\n                {orientation}\n              </option>\n            )\n          )\n        }\n      </select>\n    </div>\n    <div className=\"form-group\">\n      <NumberInput\n        _label=\"Watts\"\n        value={val.watts}\n        onChange={e => setVal(\"watts\", e.target.value)}\n      />\n      <button className=\"button\" onClick={remove}>-</button>\n    </div>\n  </>\n}\n","import React, {useState} from 'react'\nimport \"./PVArraysInfo.css\"\nimport { PVArrayInfo } from './PVArrayInfo'\n\nexport const PVArraysInfo = ({pvArrays, setPVArrays, pvArrayInit}) => {\n\n  const addArray = () => setPVArrays([...pvArrays, pvArrayInit])\n  const removeArray = i => () => setPVArrays([\n    ...pvArrays.slice(0, i),\n    ...pvArrays.slice(i + 1),\n  ])\n  const setVal = i => (key, val) => setPVArrays([\n    ...pvArrays.slice(0, i),\n    {\n      ...pvArrays[i],\n      [key]: val,\n    },\n    ...pvArrays.slice(i + 1),\n  ])\n  return <>\n    <div className=\"panels-group\">\n      <h3 className=\"pv-arrays-header\">PV Arrays</h3>\n      {pvArrays.map((pvArray, i) => (\n        <div>\n        <span className=\"array-number\">{i+ 1}.</span>\n        <PVArrayInfo\n          key={i}\n          setVal={setVal(i)}\n          remove={removeArray(i)}\n          val={pvArrays[i]}\n        />\n        </div>\n      ))}\n    <button className=\"button\" onClick={addArray}>+</button>\n    </div>\n  </>\n}","export const memoize = fn => {\n  const cache = {}\n  return (...args) => {\n    const key = JSON.stringify(args)\n    if (cache[key]) {\n      return cache[key]\n    }\n    return cache[key] = fn(...args)\n  }\n}\n","import { simpson, toRadians } from './util'\nimport { declinationsForYear } from './maps'\nimport { memoize } from '../util'\nconst SAMPLES_PER_DAY = 1000\n\nconst {\n  sin,\n  cos,\n  asin,\n  acos,\n  tan,\n  PI\n} = Math\n\nconst mCos = memoize(cos)\nconst mSin = memoize(sin)\nconst mTan = memoize(tan)\n\nexport const calculateWHFactorForYear = memoize(opts => (\n  declinationsForYear.map(dec => calculateWHFactorForDay({...opts, dec}))\n))\n\nexport const noonToSunsetRad = (lat, dec) => (\n  acos(-mTan(lat)*mTan(dec)) / toRadians(15)\n)\nexport const calculateWHFactorForDay = memoize(opts => {\n  const instantPercentage = x => {\n    const hourAngle = x*PI/12\n    if (typeof hourAngle === \"undefined\") {\n      debugger\n    }\n    const percentage = instantIntensityPercentage({\n      ...opts,\n      hourAngle\n    })\n    if (percentage < 0) {\n      return 0\n    }\n    return percentage\n  }\n  const intervalRad = noonToSunsetRad(opts.lat, opts.dec)\n  const result = simpson(instantPercentage, opts.samplesPerDay, -intervalRad, intervalRad)\n  return result\n})\n\nexport const instantIntensityPercentage = memoize(opts => {\n  const { lat, dec, tilt, orientation, hourAngle } = opts\n  const sinLat = sin(lat)\n  const sinDec = sin(dec)\n  const cosHA = cos(hourAngle)\n  const sinHA = sin(hourAngle)\n  const cosLat = cos(lat)\n  const cosDec = cos(dec)\n  const altitude = asin(sinDec * sinLat + cosDec * cosHA * cosLat)\n  const cosAlt = cos(altitude)\n\n  const tmp = (sinDec * cosLat - cosDec * cosHA * sinLat) /  cosAlt\n\n  let azimuth;\n  if (tmp < -1) {\n    azimuth = Math.PI\n  } else if (tmp > 1) {\n    azimuth = 0\n  } else {\n    azimuth = acos(tmp)\n  }\n\n  if (sinHA > 0) {\n    azimuth = 2 * PI - azimuth\n  }\n  const sinAlt = sin(altitude)\n  return sinAlt * cos(tilt) + cosAlt * sin(tilt) * cos(orientation - azimuth)\n})","import { calculateWHFactorForYear } from \"../calculations/wh-factor\"\nimport { memoize } from \"../util\"\n\n\nconst currentYear = new Date().getFullYear()\nconst getDaysInMonth = memoize((year, month) => new Date(year, month, 0).getDate())\nconst getIntervalAvg = arr => arr.reduce((acc, cur) => acc+cur, 0) / arr.length\n\nexport const getAvgProdByMonth = memoize(pvArrayInfo => {\n  const { watts, ...whFactorInfo } = pvArrayInfo\n  const whFactorForYear = calculateWHFactorForYear(whFactorInfo)\n  let curDay = 0\n  return [...new Array(12)]\n    .map((_, i) => {\n      const monthFactors = whFactorForYear\n        .slice(curDay, curDay += getDaysInMonth(currentYear, i))\n      const intervalAvg = getIntervalAvg(monthFactors)\n      return intervalAvg\n    })\n    .map(whFactor => whFactor*watts)\n})","import React, { useState } from 'react'\nimport { getAvgProdByMonth } from './energy-production'\nimport \"./styles.css\"\n\n\nconst truncate = (num, precision) => {\n  const factor = 10**precision\n  return (num * factor | 0) / factor\n}\nconst monthLabels = [\n  'Jan',\n  'Feb',\n  'Mar',\n  'Apr',\n  'May',\n  'Jun',\n  'Jul',\n  'Aug',\n  'Sep',\n  'Oct',\n  'Nov',\n  'Dec',\n]\nexport const AverageOutputPerDayByMonth = ({pvArrays, lat, samplesPerDay}) => {\n  const getAvgProdsByMonth = pvArrays => pvArrays\n    .map(pvArray => getAvgProdByMonth({...pvArray, lat, samplesPerDay}))\n  const [avgProdByMonth, setAvgProdByMonth] =\n    useState({\n      calculating: false,\n      data: [] as any[],\n      time: 0,\n    })\n\n  const calculate = () => {\n    setAvgProdByMonth({\n      data: [],\n      calculating: true,\n      time: 0,\n    })\n    setTimeout(() => {\n      const startTime = +new Date\n      const data = getAvgProdsByMonth(pvArrays)\n      const endTime = +new Date\n      setAvgProdByMonth({\n        data,\n        calculating: false,\n        time: endTime - startTime,\n      })\n    }, 0)\n  }\n\n  return (\n    <div>\n    <button className=\"button\" onClick={calculate}>Calculate</button>\n    <h3 className=\"display-header\">\n      Average Production Per Day By Month (kw/h)\n    </h3>\n    {avgProdByMonth.calculating ? <div className=\"calculating\">Calculating...</div> :\n    <>\n      <table>\n        <thead>\n          <tr>\n            <th>&nbsp;&nbsp;&nbsp;&nbsp;</th>\n            {monthLabels.map(label => <th key={label}>{label}</th>)}\n          </tr>\n        </thead>\n        <tbody>\n          {avgProdByMonth.data.map((averageProduction, i) => <tr key={i}>\n            <td>{i+1}.</td>\n            {averageProduction.map((production, i) => <td key={i}>{truncate(production / 1000, 2)}</td>)}\n          </tr>)}\n          {avgProdByMonth.time > 0 ?\n          <tr>\n            <td colSpan={13} style={{border: \"none\"}}>\n                <div className=\"calc-time\">Calculation Time: {truncate(avgProdByMonth.time/1000, 2)} seconds</div>\n            </td>\n          </tr>\n          : \"\" }\n        </tbody>\n      </table>\n    </>}\n    </div>\n  )\n}\n\nconst singleArray = averageProduction => {\n\n}\n\n","import React, {useState} from 'react';\nimport './App.css';\nimport {PVArraysInfo} from './PVArraysInfo/PVArraysInfo';\nimport { AverageOutputPerDayByMonth } from './display/AverageOutputPerDayByMonth';\nimport { toRadians } from './calculations/util';\nimport { orientationsToAzimuth } from './calculations/maps';\nimport { DegreesInput } from './ui/degrees-input';\nimport { NumberInput } from './ui/number-input';\n\nconst pvArrayInit = {\n  tilt: 0,\n  orientation: \"S\",\n  watts: 500,\n}\nconst lsPVArrays = window.localStorage.pvArrays\nconst pvArraysInit = lsPVArrays ? JSON.parse(lsPVArrays) : [pvArrayInit]\nconst latInit = window.localStorage.lat ? window.localStorage.lat : 0\nconst samplesPerDayInit = window.localStorage.samplesPerDay ? Number(window.localStorage.samplesPerDay) : 100\nconst App: React.FC = () => {\n  const [pvArrays, setPVArrays] = useState(pvArraysInit)\n  const [lat, setLat] = useState(latInit)\n  const [samplesPerDay, setSamplesPerDay] = useState(samplesPerDayInit)\n  const latAdjusted = toRadians(Number(lat))\n  const pvArraysCleaned = pvArrays.map(pvArray => ({\n    ...pvArray,\n    orientation: toRadians(orientationsToAzimuth[pvArray.orientation]),\n    tilt: toRadians(pvArray.tilt)\n  }))\n  window.localStorage.pvArrays = JSON.stringify(pvArrays)\n  window.localStorage.lat = lat\n  window.localStorage.samplesPerDay = samplesPerDay\n  return (\n    <div className=\"App\">\n      <header>\n        <h1 className=\"header\">Solar Power Calculator</h1>\n      </header>\n      <div>\n        <div className=\"form-group\">\n        <DegreesInput\n          onChange={value => setLat(value)}\n          _label=\"Latitude\"\n          value={lat}\n        />\n        </div>\n        <div className=\"form-group\">\n        <NumberInput\n          _label=\"Samples Per Day\"\n          onChange={e => setSamplesPerDay(e.target.value)}\n          value={samplesPerDay}\n        />\n        </div>\n      </div>\n      <PVArraysInfo\n        pvArrays={pvArrays}\n        setPVArrays={setPVArrays}\n        pvArrayInit={pvArrayInit}\n      />\n      <AverageOutputPerDayByMonth pvArrays={pvArraysCleaned} lat={latAdjusted} samplesPerDay={samplesPerDay} />\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}